package com.project.core.support.crypto;

import static org.assertj.core.api.Assertions.assertThat;

import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.DisplayNameGeneration;
import org.junit.jupiter.api.DisplayNameGenerator;
import org.junit.jupiter.api.Test;

@DisplayName("RSA 암복호화 기능 테스트")
@DisplayNameGeneration(DisplayNameGenerator.ReplaceUnderscores.class)
class RsaCryptoTest {
	private RsaCrypto sut = new RsaCrypto(
		"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"
	);

	@Test
	void 평문을_암호화_할_수_있다() {
		String plainText = "테스트";
		String cipherText = sut.encrypt(plainText);
		assertThat(sut.decrypt(cipherText)).isEqualTo("테스트");
	}

	@Test
	void 암호화문을_복호화_할_수_있다() {
		String cipherText = "uKaWaDDYO6kBSKL9KxKbMgyDQhwlpYZa6AnhzbrT3Sl8W1EudYENBjcEfMVH4sVczQGMOT0Et7CgPfeP7EnUdjc2Dhorqf5DrIdNEs8lOVxWxB0DK6k7ATlmjZTvgSEe4ycszZ4cYbQmfbZ1kIWs96vB4w9K9dRLqkzvSSy8G6K79yuYDCJX8eXmwohSOzqiexWSrjcdRp85blbBRmKLm2iwDYA5XjBYJSKrH6wKnvF9LcCmNKNeCz1QgqvZ0VLDNiPw27w/weW81ko+GMaTxOqyI6Q8g7iB3hxi/qGsQmYBxnAlGMznOlYBsFmMjIocXLKRowKylwALZIx0yfXqnw==";
		String plainText = sut.decrypt(cipherText);
		assertThat(plainText).isEqualTo("테스트");
	}
}